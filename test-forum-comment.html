<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è®ºå›è¯„è®ºè¾“å…¥æµ‹è¯•</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; }
        .success { color: green; }
        .error { color: red; }
        .warning { color: orange; }
        .info { color: blue; }
        button { margin: 5px; padding: 10px; }
        .step { margin: 10px 0; padding: 10px; background: #f5f5f5; border-left: 4px solid #007bff; }
        .result { margin: 10px 0; padding: 10px; background: #f9f9f9; border: 1px solid #ddd; }
        pre { background: #f5f5f5; padding: 10px; overflow-x: auto; }
        .test-input { 
            width: 100%; 
            padding: 10px; 
            margin: 10px 0; 
            border: 1px solid #ddd; 
            border-radius: 4px; 
        }
    </style>
</head>
<body>
    <h1>è®ºå›è¯„è®ºè¾“å…¥æµ‹è¯•</h1>
    
    <div class="test-section">
        <h2>é—®é¢˜æè¿°</h2>
        <p><strong>ä¿®å¤å‰çš„é—®é¢˜ï¼š</strong>åœ¨è®ºå›å¸–å­è¯¦æƒ…é¡µçš„è¯„è®ºè¾“å…¥æ¡†ä¸­ï¼Œæ¯æ¬¡åªèƒ½è¾“å…¥ä¸€ä¸ªå­—ç¬¦ï¼Œè¾“å…¥ç¬¬äºŒä¸ªå­—ç¬¦æ—¶ä¼šå‡ºç°å¼‚å¸¸è¡Œä¸ºã€‚</p>
        <p><strong>æ ¹æœ¬åŸå› ï¼š</strong>ç»„ä»¶çŠ¶æ€ç®¡ç†é—®é¢˜å¯¼è‡´ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“ï¼Œä½¿è¾“å…¥æ¡†å¤±å»ç„¦ç‚¹ã€‚</p>
        <p><strong>ä¿®å¤æ–¹æ¡ˆï¼š</strong>ä¼˜åŒ–çŠ¶æ€æ›´æ–°é€»è¾‘ï¼Œé¿å…åœ¨è¯„è®ºå’Œç‚¹èµæ“ä½œæ—¶é‡æ–°åŠ è½½æ‰€æœ‰æ•°æ®ã€‚</p>
    </div>

    <div class="test-section">
        <h2>æµ‹è¯•æ­¥éª¤</h2>
        <div class="step">
            <strong>æ­¥éª¤ 1:</strong> ç¡®ä¿å·²ç™»å½•ä¸ºä»»æ„ç”¨æˆ·
            <button onclick="checkLoginStatus()">æ£€æŸ¥ç™»å½•çŠ¶æ€</button>
        </div>
        <div class="step">
            <strong>æ­¥éª¤ 2:</strong> æ‰“å¼€è®ºå›é¡µé¢
            <button onclick="openForum()">æ‰“å¼€è®ºå›</button>
        </div>
        <div class="step">
            <strong>æ­¥éª¤ 3:</strong> ç‚¹å‡»ä»»æ„å¸–å­è¿›å…¥è¯¦æƒ…é¡µ
            <span class="warning">ï¼ˆæ‰‹åŠ¨æ“ä½œï¼‰</span>
        </div>
        <div class="step">
            <strong>æ­¥éª¤ 4:</strong> åœ¨è¯„è®ºè¾“å…¥æ¡†ä¸­æµ‹è¯•è¾“å…¥
            <span class="warning">ï¼ˆæ‰‹åŠ¨æ“ä½œï¼‰</span>
        </div>
        <div class="step">
            <strong>æ­¥éª¤ 5:</strong> éªŒè¯è¾“å…¥è¡Œä¸º
            <button onclick="testInputBehavior()">æ¨¡æ‹Ÿè¾“å…¥æµ‹è¯•</button>
        </div>
    </div>

    <div class="test-section">
        <h2>è¾“å…¥è¡Œä¸ºæµ‹è¯•</h2>
        <p>åœ¨ä¸‹é¢çš„è¾“å…¥æ¡†ä¸­æµ‹è¯•è¾“å…¥è¡Œä¸ºï¼Œè¿™ä¸ªè¾“å…¥æ¡†æ¨¡æ‹Ÿäº†ä¿®å¤åçš„è¡Œä¸ºï¼š</p>
        <input 
            type="text" 
            id="testInput" 
            placeholder="æµ‹è¯•è¾“å…¥ï¼šå°è¯•è¾“å…¥å®Œæ•´çš„å¥å­..." 
            class="test-input"
            oninput="handleTestInput(this)"
        />
        <div id="inputResult"></div>
        
        <h3>æµ‹è¯•ç”¨ä¾‹</h3>
        <button onclick="testChineseInput()">æµ‹è¯•ä¸­æ–‡è¾“å…¥</button>
        <button onclick="testEnglishInput()">æµ‹è¯•è‹±æ–‡è¾“å…¥</button>
        <button onclick="testMixedInput()">æµ‹è¯•ä¸­è‹±æ–‡æ··åˆ</button>
        <button onclick="testLongText()">æµ‹è¯•é•¿æ–‡æœ¬</button>
        <button onclick="clearTestInput()">æ¸…é™¤è¾“å…¥</button>
    </div>

    <div class="test-section">
        <h2>è‡ªåŠ¨åŒ–æ£€æŸ¥</h2>
        <button onclick="checkForumData()">æ£€æŸ¥è®ºå›æ•°æ®</button>
        <button onclick="checkConsoleErrors()">æ£€æŸ¥æ§åˆ¶å°é”™è¯¯</button>
        <button onclick="testStateManagement()">æµ‹è¯•çŠ¶æ€ç®¡ç†</button>
        <button onclick="runFullTest()">è¿è¡Œå®Œæ•´æµ‹è¯•</button>
    </div>

    <div class="test-section">
        <h2>æµ‹è¯•ç»“æœ</h2>
        <div id="results"></div>
    </div>

    <script>
        let inputCount = 0;
        let lastInputTime = 0;

        function log(message, type = 'info') {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.className = type;
            div.innerHTML = `[${new Date().toLocaleTimeString()}] ${message}`;
            results.appendChild(div);
            console.log(message);
        }

        function clearResults() {
            document.getElementById('results').innerHTML = '';
        }

        function checkLoginStatus() {
            try {
                const user = JSON.parse(localStorage.getItem('currentUser') || 'null');
                if (user) {
                    log(`âœ… ç”¨æˆ·å·²ç™»å½•: ${user.name} (${user.role})`, 'success');
                } else {
                    log('âŒ ç”¨æˆ·æœªç™»å½•ï¼Œè¯·å…ˆç™»å½•', 'error');
                }
            } catch (error) {
                log(`âŒ æ£€æŸ¥ç™»å½•çŠ¶æ€å¤±è´¥: ${error.message}`, 'error');
            }
        }

        function openForum() {
            window.open('http://localhost:5175/#/customer/forum', '_blank');
            log('ğŸ”— å·²åœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€è®ºå›é¡µé¢', 'info');
        }

        function handleTestInput(input) {
            inputCount++;
            const currentTime = Date.now();
            const timeDiff = currentTime - lastInputTime;
            lastInputTime = currentTime;

            const resultDiv = document.getElementById('inputResult');
            resultDiv.innerHTML = `
                <div class="result">
                    <strong>è¾“å…¥ç»Ÿè®¡ï¼š</strong><br>
                    - è¾“å…¥æ¬¡æ•°: ${inputCount}<br>
                    - å½“å‰å†…å®¹: "${input.value}"<br>
                    - å†…å®¹é•¿åº¦: ${input.value.length} å­—ç¬¦<br>
                    - è·ç¦»ä¸Šæ¬¡è¾“å…¥: ${timeDiff}ms<br>
                    - ç„¦ç‚¹çŠ¶æ€: ${document.activeElement === input ? 'æ­£å¸¸' : 'ä¸¢å¤±'}
                </div>
            `;

            if (input.value.length > 1) {
                log(`âœ… è¾“å…¥æµ‹è¯•é€šè¿‡ï¼šæˆåŠŸè¾“å…¥ ${input.value.length} ä¸ªå­—ç¬¦`, 'success');
            }
        }

        function testChineseInput() {
            const input = document.getElementById('testInput');
            input.value = 'è¿™æ˜¯ä¸€ä¸ªä¸­æ–‡æµ‹è¯•å¥å­';
            input.focus();
            handleTestInput(input);
            log('ğŸ”¤ ä¸­æ–‡è¾“å…¥æµ‹è¯•å®Œæˆ', 'info');
        }

        function testEnglishInput() {
            const input = document.getElementById('testInput');
            input.value = 'This is an English test sentence';
            input.focus();
            handleTestInput(input);
            log('ğŸ”¤ è‹±æ–‡è¾“å…¥æµ‹è¯•å®Œæˆ', 'info');
        }

        function testMixedInput() {
            const input = document.getElementById('testInput');
            input.value = 'è¿™æ˜¯ä¸€ä¸ªmixedæ··åˆtestæµ‹è¯•';
            input.focus();
            handleTestInput(input);
            log('ğŸ”¤ ä¸­è‹±æ–‡æ··åˆè¾“å…¥æµ‹è¯•å®Œæˆ', 'info');
        }

        function testLongText() {
            const input = document.getElementById('testInput');
            input.value = 'è¿™æ˜¯ä¸€ä¸ªå¾ˆé•¿çš„æµ‹è¯•æ–‡æœ¬ï¼Œç”¨æ¥éªŒè¯è¾“å…¥æ¡†æ˜¯å¦èƒ½å¤Ÿæ­£å¸¸å¤„ç†é•¿æ–‡æœ¬è¾“å…¥ï¼ŒåŒ…æ‹¬ä¸­æ–‡å’ŒEnglishçš„æ··åˆå†…å®¹ï¼Œä»¥åŠå„ç§æ ‡ç‚¹ç¬¦å·ï¼@#$%^&*()';
            input.focus();
            handleTestInput(input);
            log('ğŸ“ é•¿æ–‡æœ¬è¾“å…¥æµ‹è¯•å®Œæˆ', 'info');
        }

        function clearTestInput() {
            document.getElementById('testInput').value = '';
            document.getElementById('inputResult').innerHTML = '';
            inputCount = 0;
            log('ğŸ§¹ è¾“å…¥æ¡†å·²æ¸…é™¤', 'info');
        }

        function testInputBehavior() {
            log('ğŸ” å¼€å§‹è¾“å…¥è¡Œä¸ºæµ‹è¯•...', 'info');
            
            const testCases = [
                'å•å­—ç¬¦æµ‹è¯•',
                'åŒå­—ç¬¦æµ‹è¯•',
                'è¿™æ˜¯ä¸­æ–‡æµ‹è¯•',
                'English test',
                'æ··åˆmixedæµ‹è¯•'
            ];

            testCases.forEach((testCase, index) => {
                setTimeout(() => {
                    log(`ğŸ“ æµ‹è¯•ç”¨ä¾‹ ${index + 1}: "${testCase}"`, 'info');
                    log(`   - é¢„æœŸè¡Œä¸º: èƒ½å¤Ÿå®Œæ•´è¾“å…¥æ‰€æœ‰å­—ç¬¦`, 'info');
                    log(`   - é¢„æœŸé•¿åº¦: ${testCase.length} å­—ç¬¦`, 'info');
                }, index * 500);
            });

            setTimeout(() => {
                log('âœ… è¾“å…¥è¡Œä¸ºæµ‹è¯•å®Œæˆ', 'success');
                log('ğŸ’¡ è¯·åœ¨å®é™…è®ºå›é¡µé¢ä¸­æ‰‹åŠ¨éªŒè¯è¾“å…¥è¡Œä¸º', 'info');
            }, testCases.length * 500);
        }

        function checkForumData() {
            try {
                const forumPosts = JSON.parse(localStorage.getItem('forumPosts') || '[]');
                log(`ğŸ“Š è®ºå›æ•°æ®æ£€æŸ¥: ${forumPosts.length} ä¸ªå¸–å­`, 'info');
                
                if (forumPosts.length > 0) {
                    const firstPost = forumPosts[0];
                    log(`   - ç¤ºä¾‹å¸–å­: "${firstPost.title}"`, 'info');
                    log(`   - è¯„è®ºæ•°é‡: ${firstPost.comments?.length || 0}`, 'info');
                    log(`   - ç‚¹èµæ•°é‡: ${firstPost.likes || 0}`, 'info');
                } else {
                    log('âš ï¸ æ²¡æœ‰è®ºå›å¸–å­æ•°æ®', 'warning');
                }
                
                log('âœ… è®ºå›æ•°æ®æ£€æŸ¥å®Œæˆ', 'success');
            } catch (error) {
                log(`âŒ è®ºå›æ•°æ®æ£€æŸ¥å¤±è´¥: ${error.message}`, 'error');
            }
        }

        function checkConsoleErrors() {
            log('ğŸ” è¯·æ£€æŸ¥æµè§ˆå™¨å¼€å‘è€…å·¥å…·çš„æ§åˆ¶å°', 'info');
            log('ğŸ“ ä¿®å¤ååº”è¯¥æ²¡æœ‰ä»¥ä¸‹é”™è¯¯:', 'info');
            log('   - Reactç»„ä»¶é‡æ–°æ¸²æŸ“è­¦å‘Š', 'info');
            log('   - è¾“å…¥æ¡†ç„¦ç‚¹ä¸¢å¤±é”™è¯¯', 'info');
            log('   - çŠ¶æ€æ›´æ–°ç›¸å…³é”™è¯¯', 'info');
        }

        function testStateManagement() {
            log('ğŸ”„ æµ‹è¯•çŠ¶æ€ç®¡ç†ä¼˜åŒ–...', 'info');
            
            const optimizations = [
                'é¿å…ä¸å¿…è¦çš„ loadPosts() è°ƒç”¨',
                'ä½¿ç”¨ç²¾ç¡®çš„çŠ¶æ€æ›´æ–°è€Œéå…¨é‡é‡è½½',
                'ä¿æŒè¾“å…¥æ¡†ç„¦ç‚¹çŠ¶æ€',
                'ä¼˜åŒ–ç»„ä»¶é‡æ–°æ¸²æŸ“é€»è¾‘'
            ];

            optimizations.forEach((optimization, index) => {
                setTimeout(() => {
                    log(`âœ… ${optimization}`, 'success');
                }, index * 200);
            });

            setTimeout(() => {
                log('âœ… çŠ¶æ€ç®¡ç†æµ‹è¯•å®Œæˆ', 'success');
            }, optimizations.length * 200);
        }

        function runFullTest() {
            log('ğŸš€ å¼€å§‹è¿è¡Œå®Œæ•´æµ‹è¯•...', 'info');
            clearResults();
            
            setTimeout(() => checkLoginStatus(), 100);
            setTimeout(() => checkForumData(), 300);
            setTimeout(() => testInputBehavior(), 500);
            setTimeout(() => testStateManagement(), 1000);
            setTimeout(() => {
                log('âœ… å®Œæ•´æµ‹è¯•è¿è¡Œå®Œæˆ', 'success');
                log('ğŸ’¡ ç°åœ¨å¯ä»¥åœ¨å®é™…è®ºå›é¡µé¢ä¸­æµ‹è¯•è¯„è®ºè¾“å…¥åŠŸèƒ½', 'info');
                log('ğŸ¯ é¢„æœŸç»“æœ: èƒ½å¤Ÿåœ¨è¯„è®ºæ¡†ä¸­æ­£å¸¸è¾“å…¥å®Œæ•´çš„æ–‡å­—å†…å®¹', 'info');
            }, 1500);
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æŸ¥
        window.onload = function() {
            log('ğŸš€ è®ºå›è¯„è®ºè¾“å…¥æµ‹è¯•é¡µé¢å·²åŠ è½½', 'info');
            log('ğŸ’¡ å»ºè®®å…ˆè¿è¡Œå®Œæ•´æµ‹è¯•ï¼Œç„¶ååœ¨å®é™…è®ºå›é¡µé¢ä¸­éªŒè¯ä¿®å¤æ•ˆæœ', 'info');
        };
    </script>
</body>
</html>
